<script type="module">
  // After Supabase confirms the email, it redirects here with #access_token in the URL
  const hashParams = new URLSearchParams(window.location.hash.substring(1));
  const accessToken = hashParams.get('access_token');
  const type = hashParams.get('type');
  
  const statusEl = document.getElementById('status');
  const button = document.getElementById('go-app');

  if (accessToken && type === 'signup') {
    // Email confirmed successfully by Supabase
    statusEl.textContent = 'Thanksâ€”your email is confirmed! Opening the app...';
    button.textContent = 'Open Docuflow';
    button.href = 'docuflow://verify?confirmed=true';
    
    // Auto-redirect to app after 2 seconds
    setTimeout(() => {
      window.location.replace(button.href);
    }, 2000);
  } else {
    statusEl.textContent = 'Click the confirmation link in your email to verify your account.';
    button.style.display = 'none';
  }
</script>
